#!/usr/bin/env mage

# ğŸ“¦ Package Workflow Demo
# Demonstrates the comprehensive package management system

incant "ğŸ“¦ Mage Package Workflow Demo"
incant "================================"

incant ""
incant "ğŸš€ 1. Project Initialization"
incant "-----------------------------"

# Initialize a new mage project
incant "Creating new project 'my-awesome-project'..."
cast package_init("my-awesome-project")

incant ""
incant "ğŸ“‹ 2. Dependency Management"
incant "----------------------------"

# Add various types of dependencies
incant "Adding system dependencies..."
cast package_add("git", "latest", false)
cast package_add("nodejs", ">=18.0.0", false)
cast package_add("python3", "^3.9.0", false)

incant ""
incant "Adding development dependencies..."
cast package_add("curl", "latest", true)
cast package_add("jq", "latest", true)

incant ""
incant "ğŸ“Š 3. Viewing Dependencies"
incant "---------------------------"
cast package_list()

incant ""
incant "ğŸ”§ 4. Installing Dependencies"
incant "------------------------------"

# Install production dependencies
incant "Installing production dependencies..."
cast package_install()

incant ""
incant "Installing development dependencies..."
cast package_install("--dev")

incant ""
incant "ğŸ” 5. Package Information"
incant "--------------------------"
cast package_info("git")

incant ""
incant "ğŸ“ 6. Advanced Package Sources"
incant "-------------------------------"

incant "Example manifest with various package sources:"
incant ""
incant "[dependencies]"
incant "git = { version = \"latest\", source = \"auto\" }"
incant "nodejs = { version = \">=18.0.0\", source = \"auto\" }"
incant "my-tool = { version = \"1.0.0\", source = { git = { url = \"https://github.com/user/my-tool.git\", rev = \"v1.0.0\" } } }"
incant "local-lib = { version = \"dev\", source = { path = \"../local-lib\" } }"
incant "binary-tool = { version = \"latest\", source = { url = \"https://releases.example.com/tool.tar.gz\" } }"

incant ""
incant "ğŸ¯ 7. Platform-Specific Dependencies"
incant "------------------------------------"

incant "Example platform-specific dependencies:"
incant ""
incant "[dependencies]"
incant "windows-tool = { version = \"1.0.0\", platform = \"windows\" }"
incant "macos-tool = { version = \"1.0.0\", platform = \"macos\" }"
incant "linux-tool = { version = \"1.0.0\", platform = \"linux\" }"

incant ""
incant "âš™ï¸  8. Project Scripts"
incant "----------------------"

incant "Available project scripts:"
incant "â€¢ mage run setup    - Install system dependencies"
incant "â€¢ mage run build    - Build the project"
incant "â€¢ mage run test     - Run tests"

incant ""
incant "ğŸ“ 9. Project Structure"
incant "------------------------"

incant "Generated project structure:"
incant "my-awesome-project/"
incant "â”œâ”€â”€ mage.toml           # Project manifest"
incant "â”œâ”€â”€ mage.lock           # Dependency lock file"
incant "â”œâ”€â”€ scripts/"
incant "â”‚   â”œâ”€â”€ setup.mage      # Setup script"
incant "â”‚   â”œâ”€â”€ build.mage      # Build script"
incant "â”‚   â””â”€â”€ test.mage       # Test script"
incant "â”œâ”€â”€ lib/                # Library code"
incant "â”œâ”€â”€ tests/              # Test files"
incant "â””â”€â”€ .mage/"
incant "    â””â”€â”€ packages/       # Package cache"

incant ""
incant "ğŸ”„ 10. Dependency Resolution"
incant "-----------------------------"

incant "The package system provides:"
incant "â€¢ ğŸ“‹ Declarative dependency management"
incant "â€¢ ğŸ”’ Lock files for reproducible builds"
incant "â€¢ ğŸŒ Cross-platform package mapping"
incant "â€¢ ğŸ“¦ Multiple package sources (registry, git, path, url)"
incant "â€¢ ğŸ¯ Platform-specific dependencies"
incant "â€¢ âš¡ Parallel dependency installation"
incant "â€¢ ğŸ” Intelligent package search and selection"

incant ""
incant "âœ¨ Package workflow demo complete!"
incant "ğŸš€ Ready to build amazing projects with mage!" 