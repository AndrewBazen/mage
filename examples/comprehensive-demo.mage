incant "ğŸ§™â€â™‚ï¸ MAGE LANGUAGE COMPREHENSIVE TEST SUITE ğŸ§™â€â™‚ï¸"
incant "======================================================"

# ===============================================
# SECTION 1: BASIC LANGUAGE FEATURES
# ===============================================
incant "\nğŸ“ SECTION 1: Basic Language Features"

# Variable declarations (conjure)
conjure name = "Mage Wizard"
conjure age = 42
conjure is_magical = true
conjure pi = 3.14159

incant "\nâœ… Variables:"
incant "  Name: ${name}"
incant "  Age: ${age}"
incant "  Magical: ${is_magical}"
incant "  Pi: ${pi}"

# String interpolation variations
conjure greeting = "Hello, ${name}! You are $age years old."
incant "\nâœ… String Interpolation: ${greeting}"

# Escape sequences
conjure escaped = "Line 1\nLine 2\tTabbed\r\nCarriage Return\nQuote: \"Hello\"\nBackslash: \\"
incant "\nâœ… Escape Sequences:\n${escaped}"

# ===============================================
# SECTION 2: EXPRESSIONS AND ARITHMETIC
# ===============================================
incant "\nğŸ§® SECTION 2: Expressions and Arithmetic"

conjure a = 10
conjure b = 3
conjure sum = (a + b)
conjure diff = (a - b)
conjure product = (a * b)
conjure quotient = (a / b)
conjure remainder = (a % b)

incant "\nâœ… Arithmetic Operations:"
incant "  ${a} + ${b} = ${sum}"
incant "  ${a} - ${b} = ${diff}"
incant "  ${a} * ${b} = ${product}"
incant "  ${a} / ${b} = ${quotient}"
incant "  ${a} % ${b} = ${remainder}"

# ===============================================
# SECTION 3: CONTROL FLOW
# ===============================================
incant "\nğŸ”€ SECTION 3: Control Flow"

# If-else-if-else (scry-morph-lest)
conjure test_value = 15
incant "\nâœ… Conditional Logic (scry-morph-lest):"
scry test_value > 20 {
    incant "  Value is greater than 20"
} morph test_value > 10 {
    incant "  Value is between 11 and 20"
} lest {
    incant "  Value is 10 or less"
}

# Multiple conditions
conjure x = 5
conjure y = 10
scry x == 5 {
    incant "  x equals 5 âœ“"
}
scry y != 5 {
    incant "  y does not equal 5 âœ“"
}

# ===============================================
# SECTION 4: LOOPS
# ===============================================
incant "\nğŸ”„ SECTION 4: Loops"

# For loop (chant)
incant "\nâœ… For Loop (chant from/to/step):"
chant i from 1 to 6 {
    incant "  Count: ${i}"
}

incant "\nâœ… For Loop with Step:"
chant j from 0 to 11 step 2 {
    incant "  Even: ${j}"
}

incant "\nâœ… Backward For Loop:"
chant k from 5 to 1 step -1 {
    incant "  Countdown: ${k}"
}

# Foreach loop (recite)
incant "\nâœ… Foreach Loop (recite):"
conjure fruits = "apple,banana,orange,grape"
recite fruit from fruits {
    incant "  - ${fruit}"
}

incant "\nâœ… Numeric Iteration:"
conjure count = 4
recite num from count {
    incant "  Number: ${num}"
}

# While loop (channel)
incant "\nâœ… While Loop (channel):"
conjure counter = 0
channel counter < 3 {
    incant "  Counter: ${counter}"
    conjure counter = (counter + 1)
}

# ===============================================
# SECTION 5: FUNCTIONS
# ===============================================
incant "\nğŸ¯ SECTION 5: Functions"

# Function definition (enchant)
enchant greet(person) {
    incant "Hello, ${person}! Welcome to Mage."
}

enchant add_numbers(num1, num2) {
    conjure result = (num1 + num2)
    incant "Adding ${num1} + ${num2} = ${result}"
}

enchant fibonacci(n) {
    scry n <= 1 {
        incant "Fibonacci(${n}) = ${n}"
    } lest {
        incant "Fibonacci sequence up to ${n}:"
        conjure a = 0
        conjure b = 1
        incant "  ${a}"
        incant "  ${b}"
        conjure i = 2
        channel i <= n {
            conjure next = (a + b)
            incant "  ${next}"
            conjure a = b
            conjure b = next
            conjure i = (i + 1)
        }
    }
}

incant "\nâœ… Function Calls:"
cast greet("Alice")
cast add_numbers(15, 27)
cast fibonacci(7)

# ===============================================
# SECTION 6: BUILT-IN FUNCTIONS - SYSTEM INFO
# ===============================================
incant "\nğŸ’» SECTION 6: Built-in Functions - System Info"

incant "\nâœ… System Information:"
cast platform()
cast architecture()
cast home_directory()
cast current_directory()

incant "\nâœ… Environment Variables:"
cast env_var("PATH")
cast env_var("USER")
cast env_var("HOME")

# ===============================================
# SECTION 7: BUILT-IN FUNCTIONS - PACKAGE MANAGEMENT
# ===============================================
incant "\nğŸ“¦ SECTION 7: Built-in Functions - Package Management"

incant "\nâœ… Package Manager Detection:"
cast detect_package_managers()

incant "\nâœ… Package Installation Check:"
cast package_installed("git")
cast package_installed("nonexistent-package-xyz")

# NOTE: Commenting out actual installation to avoid side effects
# incant "\nâœ… Package Installation (commented out for safety):"
# cast install_package("curl")

# ===============================================
# SECTION 8: BUILT-IN FUNCTIONS - FILE OPERATIONS
# ===============================================
incant "\nğŸ“ SECTION 8: Built-in Functions - File Operations"

incant "\nâœ… File Operations:"

# Create a test directory
cast ensure_directory("test-mage-dir")

# Write a test file
cast write_file("test-mage-dir/test.txt", "Hello from Mage!\nThis is a test file.\nWith multiple lines.")

# Copy the file
cast copy_file("test-mage-dir/test.txt", "test-mage-dir/test-copy.txt")

# Make file executable (safe on all platforms)
cast make_executable("test-mage-dir/test.txt")

# Create a symlink (might fail on Windows without admin)
# cast symlink("test-mage-dir/test.txt", "test-mage-dir/test-link.txt")

incant "  Files created successfully in test-mage-dir/"

# Clean up
cast remove_file("test-mage-dir/test.txt")
cast remove_file("test-mage-dir/test-copy.txt")
cast remove_directory("test-mage-dir")

incant "  Files cleaned up successfully"

# ===============================================
# SECTION 9: DATA TYPES AND COLLECTIONS
# ===============================================
incant "\nğŸ“Š SECTION 9: Data Types and Collections"

incant "\nâœ… String Operations:"
conjure str1 = "Hello"
conjure str2 = "World"
conjure combined = (str1 + " " + str2)
incant "  Combined: ${combined}"

incant "\nâœ… List-like String Processing:"
conjure colors = "red,green,blue,yellow"
incant "  Colors list: ${colors}"
recite color from colors {
    incant "    Color: ${color}"
}

incant "\nâœ… Map-like String Processing:"
conjure person_data = "{name: John, age: 30, city: NYC}"
incant "  Person data: ${person_data}"
recite key from person_data {
    incant "    Key: ${key}"
}

# ===============================================
# SECTION 10: COMPLEX SCENARIOS
# ===============================================
incant "\nğŸ­ SECTION 10: Complex Scenarios"

# Nested loops with conditions
incant "\nâœ… Nested Loops with Conditions:"
conjure matrix_size = 3
chant row from 1 to (matrix_size + 1) {
    chant col from 1 to (matrix_size + 1) {
        conjure product = (row * col)
        scry product > 5 {
            incant "    [${row},${col}] = ${product} (>5)"
        } lest {
            incant "    [${row},${col}] = ${product}"
        }
    }
}

# Function with loops and conditions
enchant process_data(data_str) {
    incant "  Processing data: ${data_str}"
    recite item from data_str {
        scry item == "important" {
            incant "    â­ IMPORTANT: ${item}"
        } lest {
            incant "    ğŸ“„ Regular: ${item}"
        }
    }
}

incant "\nâœ… Complex Function Call:"
cast process_data("normal,important,regular,important")

# ===============================================
# SECTION 11: ERROR HANDLING AND EDGE CASES
# ===============================================
incant "\nâš ï¸ SECTION 11: Error Handling and Edge Cases"

incant "\nâœ… Empty String Handling:"
conjure empty_str = ""
recite item from empty_str {
    incant "  âŒ This should not print"
}
incant "  Empty string handled correctly"

incant "\nâœ… Zero Iteration:"
conjure zero = 0
recite item from zero {
    incant "  âŒ This should not print"
}
incant "  Zero iteration handled correctly"

incant "\nâœ… Boolean Iteration:"
conjure flag = true
recite item from flag {
    incant "  Boolean iteration: ${item}"
}

# ===============================================
# FINAL SUMMARY
# ===============================================
incant "\nğŸ‰ COMPREHENSIVE TEST COMPLETE! ğŸ‰"
incant "======================================"
incant ""
incant "âœ… Variables and Expressions"
incant "âœ… String Interpolation and Escape Sequences" 
incant "âœ… Arithmetic Operations"
incant "âœ… Conditional Logic (scry/morph/lest)"
incant "âœ… For Loops (chant from/to/step)"
incant "âœ… Foreach Loops (recite)"
incant "âœ… While Loops (channel)"
incant "âœ… Function Definition and Calls (enchant/cast)"
incant "âœ… Built-in System Information Functions"
incant "âœ… Built-in Package Management Functions"
incant "âœ… Built-in File Operations"
incant "âœ… Data Types and Collections"
incant "âœ… Complex Nested Scenarios"
incant "âœ… Error Handling and Edge Cases"
incant ""
incant "ğŸ§™â€â™‚ï¸ All Mage language features tested successfully!"
incant "   Mage is ready for magical automation! âœ¨" 